---
title: 案例研究 - HoloTour
description: 浏览 HoloTour 应用程序案例研究，并演练捕获和创建其内容的过程。
author: dannyaskew
ms.author: daaske
ms.date: 03/21/2018
ms.topic: article
keywords: HoloTour、HoloLens、Windows Mixed Reality
ms.openlocfilehash: 7e9bc2078e90b0f0cd98cf0612b583c06b2d51b400d682d3aff71e59eed620a4
ms.sourcegitcommit: a1c086aa83d381129e62f9d8942f0fc889ffcab0
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/05/2021
ms.locfileid: "115202196"
---
# <a name="case-study---holotour"></a>案例研究 - HoloTour

HoloTour for Microsoft HoloLens提供世界各地的沉浸式 3D 个人教程。 正如致力于此项目的设计者、艺术家、制作者、音频设计人员和开发人员所发现，在已知位置创建一个真实真实的 3D 渲染采用独特的创意和技术向导。 此案例研究将演练捕获和创建用于 HoloTour 的内容的过程。

## <a name="the-tech"></a>技术

借助 HoloTour，我们希望人们能够访问世界上一些最令人惊叹的目的地，例如 [Machu Pic一一在 Machu Pic一s](https://en.wikipedia.org/wiki/Machu_Picchu) in The Modern day In The [Piazza Nav分](https://en.wikipedia.org/wiki/Piazza_Navona) （位于意大利）的自己房间。 我们的团队将 HoloTour 的目标设定为"让你感觉自己确实在那里"。 体验不仅仅是图片或视频。 通过利用独特的视频显示、跟踪和音频技术HoloLens我们几乎可以将你传输到另一个地方。 我们需要捕获我们访问过的所有位置的响声、声音和三维几何图形，然后在应用中重新创建它。

为此，我们需要具有定向音频捕获的 360° 相机设备。 它需要以极高分辨率进行捕获，这样，在 HoloLens 上播放时，片段看起来会非常清晰，并且需要将相机靠近在一起，以最大程度地减少拼接项目。 我们希望完全球面覆盖，不只是在水平范围内，而且还要高于和低于你。 该钻取机还需要可移植，以便我们可以将它用于世界各地。 我们评估了可用的现成选项，并意识到由于分辨率、成本或大小，它们不足以实现我们的目标。 如果我们找不到满足需求的相机设备，我们必须自己构建一个。

### <a name="building-the-rig"></a>生成设备

第一个版本（由 mac、Velcro、磁带和 14 个 GoPro 相机制作）是 MacGyver 所想的。 查看从低端解决方案到自定义制造设备的所有内容后，GoPro 相机最终是最佳选择，因为它们很小、经济实惠，并且具有易于使用的内存存储。 小外形尺寸尤其重要，因为它使我们能够将相机相当靠近一起-相机之间的距离越小，拼结项目就越小。 我们独特的相机排列方式使我们能够获得完整的球体覆盖度以及足够的重叠度，以智能地对齐相机，并平滑处理拼接过程中的部分项目。

若要创建[真正](../design/spatial-sound.md)真实的沉浸式体验，HoloLens上的空间音效功能至关重要。 我们使用了三角架上摄像头下的四麦克风阵列，该阵列从相机位置四个方向捕获声音，为我们提供足够的信息，以在场景中创建空间声音。

![我们设置为在 Pantheon 外部拍摄设置的 360° 相机设备。](images/camera-pantheon-200px.png)

我们设置为在 Pantheon 外部拍摄设置的 360° 相机设备。 


我们测试了家装机，因为它位于西雅图附近的 Rattlesnake 一角，并捕获了树的顶部的云。 虽然结果明显不如现在在 HoloTour 中看到的位置，但结果让我们相信，我们的钻路设计足够好，让你感觉自己确实在那里。

我们将我们的设备从 Velcro 和 windows 升级到了 3D 打印相机外壳，并购买了用于 GoPro 相机的外部电池包，以简化电池管理。 然后，我们进行了一项更广泛的测试，前往旧金山，以创建城市及其金门桥的经典之旅。 此相机设备用于捕获你在 HoloTour 中访问的位置。

![Machu Pic一中拍摄 360° 相机设备。](images/camera-machu-pichu-500px.png)

Machu Pic一中拍摄 360° 相机设备。 

## <a name="behind-the-scenes"></a>幕后

在拍摄之前，我们需要确定想要在虚拟教程中包括的位置。 Rome 是我们要发货的第一个位置，我们希望正确操作，因此，我们决定提前进行一次侦查行程。 我们发送了一个包含六个人（包括艺术家、设计人员和制作者）的团队，以现场访问我们正在考虑的网站。 行程大约需要 9 天 – 2.5 天用于旅行，其余时间用于拍摄。  (Machu Pic一开始，我们选择不进行侦查之旅，提前研究并预订几天的缓冲区用于电影。) 

在意大利期间，该团队拍摄了每个区域的照片，并注意了有趣的事实以及实际注意事项，例如，前往每个地点的难度，以及由于人流或限制而难以拍摄。 这看起来像是一个假期，但有很多工作。 天从凌晨开始，一直持续到晚上。 每天晚上，都上传了视频片段，让团队回到西雅图查看。 

![我们在意大利的捕获人员。](images/holotour-filming-crew-rome-500px.jpg) 

我们在意大利的捕获人员。 


完成 scout 行程后，为实际拍摄制定最终计划。 这需要一个详细列表，其中列出了我们要在哪一天、什么时间拍摄电影。 每天的非常昂贵，因此这些行程需要高效。 我们在 Rome 预订了指南和处理程序来帮助我们，并每天从节前到节后充分利用这些指南和处理程序。 我们需要尽可能获得最佳的影像，让你感觉自己确实在那里。

### <a name="capturing-the-video"></a>捕获视频

在捕获期间执行一些简单操作可以更轻松地进行后期处理。 例如，每次将多个相机的图像拼结在一起时，最终都会生成视觉项目，因为每个相机的视图略有不同。 对象越接近相机，视图之间的差越大，拼接项目越大。 下面是可视化问题的一种简单方法：在人脸前面按住大拇指，仅用一只眼睛查看它。 现在切换眼睛。 你将看到滚动块似乎相对于背景移动。 如果你将滚动块离人脸更远一些，然后重复试验，则你的滚动块似乎移动得更少。 这种明显的移动类似于我们面临的拼接问题：眼睛像照相机一样，看不到完全相同的图像，因为它们之间的距离有点远。

由于在拍摄时防止最差的项目比在后期处理中更正它们要容易得多，因此，我们尝试将人们和事物放在远离照相机的地方，我们可以消除拼结关闭对象需求。 在相机周围保持大型清除可能是我们在拍摄期间面临的最大挑战之一，我们必须获得创意才能使其正常工作。 使用本地指南在管理人们方面是一项巨大的帮助，但我们还发现，使用标志（有时是小圆球或 bean 包）来标记我们的电影空间相当有效，尤其是因为我们只需要在每个位置获取少量的视频。 通常，获取良好捕获的最佳方法就是，在大多数人出现之前，在一大早到达。

其他一些有用的捕获技术直接来自传统的电影实践。 例如，我们在所有相机上使用了颜色更正卡，并捕获了稍后可能需要的纹理和对象的参考照片。 

![显示颜色更正卡的 Machu Pic一的粗略剪切。](images/rough-cut-machu-picchu-500px.png)

拼结前的 Pantheon 片段的粗略剪切。

### <a name="processing-the-video"></a>处理视频

捕获 360° 内容只是第一步-需要大量处理才能将捕获的原始相机视频转换为在 HoloTour 中看到的最终资产。 回到家后，我们需要从 14 个不同的相机源拍摄视频，将其转换为包含最少项目的单个连续视频。 我们的艺术团队使用多种工具来组合和优化捕获的片段，我们开发了一个管道来尽可能优化处理。 该片段必须拼接在一起，进行颜色更正，然后进行复合，以删除令人分散注意力的元素和项目，或添加生命和运动的补充性，所有这些都目的是增强实际存在感。

![拼结前的 Pantheon 片段的粗略剪切。](images/rough-cut-pantheon-500px.png)

拼结前的 Pantheon 片段的粗略剪切。 


为了将视频拼结在一起，我们使用了名为 [PTGui 的工具](https://www.ptgui.com/) ，并集成到处理管道中。 在后期处理过程中，我们从视频中提取了帧，并发现了一种适合其中一个帧的拼接模式。 然后，我们将该模式应用于我们撰写的自定义插件，该插件允许视频艺术家在 After Effects 中撰写时直接微调和调整拼接模式。 

![PTGui 的屏幕截图，其中显示了拼结的 Pantheon 片段。](images/stitching-tool-pantheon-500px.png)

PTGui 的屏幕截图，其中显示了拼结的 Pantheon 片段。 


### <a name="video-playback"></a>视频播放

完成视频处理后，我们有一个无缝视频，但它非常大，分辨率约为 8K。 解码视频成本高昂，并且只有极少数计算机可以处理 8K 视频，因此下一个难题是找到一种在视频上播放此HoloLens。 我们开发了许多策略来避免解码成本，同时仍让用户感觉自己正在观看整个视频。

最简单的优化是避免解码不会更改太多内容的视频部分。 我们编写了一个工具，用于识别每个场景中运动很少或没有运动的区域。 对于这些区域，我们将显示静态图像，而不是在每个帧中解码视频。 为此，我们将大型视频划分为更小的区块。

我们还确保我们解码的每一个像素都最有效地使用。 我们试验了压缩技术来减小视频的大小;我们根据要投射到的几何图形的多边形拆分视频区域;我们调整了VS，并基于包含的不同多边形的详细信息重新打包了视频。 此工作的结果是，作为单个 8k 视频启动的视频变成许多区块，这些区块看起来几乎无法理解，直到它们正确重新预测到场景中。 对于了解纹理映射和 UV 打包的游戏开发人员来说，这可能看起来很熟悉。 

![优化前的 Pantheon 的完整视图。](images/pantheon-before-optimization-500px.png) 

优化前的 Pantheon 的完整视图。 


![Pantheon 的右半部分，已处理用于视频播放。](images/pantheon-process-video-playback-500px.png) 

Pantheon 的右半部分，已处理用于视频播放。 


![优化和打包后的单个视频区域的示例。](images/single-video-region-after-optimization-500px.png) 

优化和打包后的单个视频区域的示例。 


我们使用的另一个技巧是避免对未主动观看的视频进行解码。 在 HoloTour 中，在任何给定时刻，只能查看部分完整场景。 我们仅在 FOV)  (的视图范围内或不久内解码视频。 旋转头时，我们开始播放 FOV 中的视频区域，并停止播放其中不再存在的视频区域。 大多数人都不会注意到这种情况，但如果您迅速翻了，您将看到视频需要一秒钟的时间，在这种情况下，您将看到一个静态图像，该图像随后会在视频准备就绪后淡回到视频。

为实现此策略，我们开发了大量视频播放系统。 我们优化了低级播放代码，使视频切换功能极为高效。 此外，我们还必须以一种特殊的方式对我们的视频进行编码，以便随时可以快速切换到任何视频。 此播放管道需要大量的开发时间，因此我们分阶段实现。 我们开始时使用的是一个更简单的系统，但允许的设计人员和艺术家能处理体验，并使其变得更可靠，使我们能够通过最终质量栏提供。 此最终系统包含我们在 Unity 中创建的自定义工具，用于设置场景中的视频和监视播放引擎。

### <a name="recreating-near-space-objects-in-3d"></a>在三维中重新创建近空间对象

视频构成了你在 HoloTour 中看到的大部分内容，但有许多三维对象出现在靠近你的范围内，例如在 Piazza Navona 中进行绘制，Pantheon 外的 fountain，或者你为高空场景提供的热气球。 这些3D 对象非常重要，因为人机深度认知非常好地靠近，而不是太好了。 我们可以在远处远离视频，但为了使用户能够浏览其空间，并使其看起来像是真正的，附近的对象需要深度。 此方法类似于你可能在自然历史记录博物馆中看到的内容，例如，在前台使用具有物理 landscaping、植物和动物 specimens 的 diorama，但 recedes 进入背景中的巧妙屏蔽的遮罩绘图。

某些对象只是我们创建并添加到场景中的3D 资产，旨在增强体验。 绘图和热气球落在此类别中，因为我们 filmed 时它们不存在。 与游戏资产类似，它们是由团队中的3D 艺术家创建的，并相应地纹理。 我们将它们放在离您的位置附近的场景中，游戏引擎可以将其呈现给两 HoloLens 显示，以便它们显示为三维对象。

其他资产（如 Pantheon 外的 fountain）是存在于我们的视频的位置的实际对象，但若要将这些对象移出视频和3D，我们必须执行一些操作。

首先，我们需要有关每个对象的其他信息。 在与的位置上，我们的团队捕获了这些对象的很多参考资料，以便我们有足够的详细图像来准确地重新创建纹理。 此团队还执行了 [photogrammetry](https://en.wikipedia.org/wiki/Photogrammetry) 扫描，该扫描从数十个2d 图像构造一个3d 模型，为我们提供了理想规模的对象模型。

处理素材时，会从视频中删除以后将替换为3D 表示形式的对象。 3D 资产基于 photogrammetry 模型，但由我们的艺术家进行了清理和简化。 对于某些对象，我们可以使用视频的某些部分（例如 fountain 上的水纹理），但大多数 fountain 现在都是3D 对象，这使用户可以在体验范围内发现深度并浏览。 这种接近空间的对象大大增加了真实意义，并有助于在虚拟位置中使用户接地。 

![删除 fountain 的 Pantheon 素材。 它将替换为3D 资产。](images/object-removal-pantheon-500px.png)

删除 fountain 的 Pantheon 素材。 它将替换为3D 资产。


## <a name="final-thoughts"></a>结束语

很明显，创建此内容比我们在此处讨论的内容更多。 有几种场景：我们喜欢 "可能的透视"，其中包括热气球的 gladiator 和 Colosseum 中的 ""，这种方法更具创造性。 我们将在将来的案例研究中解决这些情况。

我们希望在生产过程中，将解决方案共享到一些更大的挑战对于其他开发人员非常有用，并且您可以使用其中一些技术来创建自己的 HoloLens 的沉浸式体验。  (如果你这样做，请务必在[HoloLens 应用开发论坛](https://forums.hololens.com/)！上与我们分享！ ) 

## <a name="about-the-authors"></a>关于作者

<table style="border:0">
<tr>
<td style="border:0" width="60px"> <img alt="David Haley" width="60" height="60" src="images/haley.png" /></td>
<td style="border:0" width="408"> <b>David Haley</b> 是一名高级开发人员，他们已经了解了有关照相机 rig 和视频播放的详细信息，而不是在 HoloTour 上使用。</td>
<td style="border:0" width="60px"> <img alt="Danny Askew" width="60" height="60" src="images/askew.png" /></td>
<td style="border:0" width="408"> <b>Danny Askew</b> 是一位视频音乐家，可确保您通过罗马的旅程尽可能完美。</td>
</tr>
<tr>
<td style="border:0" width="60px"> <img alt="Jason Syltebo" width="60" height="60" src="images/syltebo.png" /></td>
<td style="border:0" width="408"> <b>Jason Syltebo</b> 是一种音频设计人员，它可以确保你访问的每个目标的 soundscape，即使在你返回时也是如此。</td>
<td style="border:0" width="60px"> <img alt="Travis Steiner" width="60" height="60" src="images/steiner.png" /></td>
<td style="border:0" width="408"> <b>Travis Steiner</b> 是一位设计主管，在站点上研究和 scouted 位置、创建行程计划和定向的与。</td>
</tr>
</table>



## <a name="see-also"></a>另请参阅
* [视频： Microsoft HoloLens： HoloTour](https://www.youtube.com/watch?v=pLd9WPlaMpY)
