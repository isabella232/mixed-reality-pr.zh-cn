---
title: 空间定位点
description: 了解在混合现实应用程序中使用空间定位点呈现稳定全息影像的最佳实践。
author: thetuvix
ms.author: alexturn
ms.date: 02/24/2019
ms.topic: article
keywords: 坐标系、空间坐标系、世界规模、世界、刻度、位置、方向、定位点、空间定位点、世界锁定、世界锁定、持久性、共享、混合现实头戴显示设备、Windows 混合现实头戴显示设备、虚拟现实头戴显示设备、HoloLens
ms.openlocfilehash: dc9b57d51f4202499d82abb8d210261d2ee36dc60bb90ed039a7554f82af79a0
ms.sourcegitcommit: a1c086aa83d381129e62f9d8942f0fc889ffcab0
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/05/2021
ms.locfileid: "115193511"
---
# <a name="spatial-anchors"></a>空间定位点

空间定位点表示系统在一段时间跟踪的世界上的一个重要点。 每个定位点都有一个[](coordinate-systems.md)可调整的坐标系（基于其他定位点或参考帧）以确保定位的全息影像保持精确位置。  在定位点的坐标系中渲染全息影像，可让你在任何给定时间最精确地定位该全息影像。 这是因为，随着系统根据现实世界不断将全息影像移回位置，随着时间的推移，对全息影像的位置进行少量调整。

还可以跨应用程序会话和跨设备保留和共享空间定位点：
* 通过将本地空间定位点保存至磁盘并稍后将其加载回磁盘，应用程序可以在单个数据库上的多个应用程序会话中计算HoloLens。
* 通过使用<a href="/azure/spatial-anchors/overview" target="_blank">Azure 空间定位点</a>创建云定位点，应用程序可以跨多个 HoloLens、iOS 和 Android 设备共享空间定位点。 通过让每个设备使用相同的空间定位点呈现全息影像，用户将看到全息影像出现在现实世界中的同一位置。 这可实现实时共享体验。
* 还可以将<a href="/azure/spatial-anchors/overview" target="_blank">Azure 空间定位</a>点用于跨设备、iOS HoloLens Android 设备的异步全息影像持久性。 通过共享持久云空间定位点，多个设备可以观察一段时间相同的持久全息影像，即使这些设备不同时存在于一起。

对于将保持 5 米长度的远程桌面头戴显示设备，若要获得长期缩放或房间缩放体验，通常可以使用阶段参考框架，而不是[](coordinate-systems.md#stage-frame-of-reference)空间定位点，它提供用于呈现所有内容的单一坐标系。 但是，如果应用程序允许用户在HoloLens 5 米之外漫游，可能在整个建筑物楼层中运行，则需要空间定位点以保持内容稳定。

虽然空间定位点非常适合应该在世界中保持固定的全息影像，但是放置定位点后，它便无法移动。 定位点的替代项更适用于与用户一起标记的动态全息影像。 最好使用固定的参考框架定位动态全息影像 (Unity 世界坐标的基础) 或附加的参考框架。

## <a name="best-practices"></a>最佳实践

这些空间定位点指南将帮助你呈现稳定的全息影像，准确跟踪现实世界。

### <a name="create-spatial-anchors-where-users-place-them"></a>在用户需要放置空间定位点的位置创建空间定位点

通常，用户是显式放置空间定位点的用户。

例如，在HoloLens，应用程序可以将用户的凝视射线与空间映射网格相交，[](gaze-and-commit.md)以允许用户决定放置[](spatial-mapping.md)全息影像的位置。 当用户点击放置该全息影像时，在交点创建空间定位点，然后将全息影像放在该定位点坐标系统的原点。

本地空间定位点易于创建且性能高。 如果多个定位点可以共享其基础传感器数据，系统会合并内部数据。 建议为用户显式定位的每个全息影像创建新的本地空间定位点，但下面所述的情况除外，例如全息影像的严格组。

### <a name="always-render-anchored-holograms-within-3-meters-of-their-anchor"></a>始终呈现定位点 3 米范围内的锚定的全息影像

空间定位点稳定定位点原点附近的坐标系。 如果渲染距离原点超过 3 米的全息影像，全息影像可能会遇到明显的位置错误，因为它们与原点的距离成正比，因为手部影响。 如果用户位于定位点附近，则此操作有效，因为全息影像也远离用户。 换句话说，远程全息影像的角误差很小。 但是，如果用户向上浏览到这个远方的全息影像，则其视图中会很大，使远方定位点原点的引导手效果显而易见。

### <a name="group-holograms-that-should-form-a-rigid-cluster"></a>聚集应形成固定群集的全息影像

如果应用程序希望这些全息影像保持彼此的固定关系，多个全息影像可以共享同一空间定位点。

例如，如果要在房间中对全息太阳能系统进行动画，最好将所有太阳能系统对象都固定到中心的单个定位点。 这样，它们就会彼此顺畅地移动。 在这种情况下，是作为一个整体进行定位的太阳能系统，即使其组件部件正在围绕定位点动态移动。

保持全息影像稳定性的关键注意事项是遵循上述 3 米规则。

### <a name="render-highly-dynamic-holograms-using-the-stationary-frame-of-reference-instead-of-a-local-spatial-anchor"></a>使用固定参照系（而不是局部空间定位点）呈现高度动态全息影像

如果具有高度动态的全息影像，例如，在房间中四处移动的字符或沿着用户附近的墙的浮动 UI，则最好跳过本地空间定位点，直接在固定参考框架提供的坐标系中呈现这些全息[影像。](coordinate-systems.md#stationary-frame-of-reference) 在 Unity 中，通过将全息影像直接放置在世界坐标中而不使用 WorldAnchor 来实现此目的。 全息影像在固定参考帧中，当用户远离全息影像时，可能会遇到偏移。 但对于动态全息影像来说，这不太可能明显：全息影像在不断移动，或者其运动不断靠近用户，这样偏移将最小化。

动态全息影像的一个有趣的例子是创建从一个锚定坐标系到另一个锚定坐标系的动画的对象。 例如，你可能有两座距离 10 米的堡垒，每个都位于其自己的空间定位点上，其中一个堡垒向另一座林中发射一个火箭球。 激发后，可以将它呈现在固定参考框架中的适当位置，以与第一个堡垒的锚定坐标系中的球保持一致。 然后，它可以循着它在固定参照系中的轨迹，在空中飞行 10 米。 当球到达另一座堡垒时，你可以将其移动到第二座堡垒的锚定坐标系中，以允许使用该堡垒的刚体进行物理计算。

如果要跨设备共享高度动态的全息影像，请选择一些云空间定位点来充当其父级，因为固定参考帧无法跨设备共享。  但是，应确保动态全息影像或查看它的设备停留在定位点的 3 米半径内，以便全息影像在所有设备上都稳定显示。

### <a name="avoid-creating-a-grid-of-spatial-anchors"></a>避免创建空间定位点网格

你可能想要在用户四处移动时让应用程序删除空间定位点的常规网格，在动态对象四处移动时将动态对象从定位点转换为定位点。 但是，这涉及到对应用程序的更多管理，而不受益于系统本身在内部维护的深层传感器数据。 对于这些情况，你将全息影像放置在固定参考框架中，如上一部分所述，获得更好的结果。
在静态空间周围预先定位一组云空间定位点时，请考虑将空间定位点放置在用户根据上述原则遇到的关键全息影像的位置，而不是创建任意定位点网格。 该操作可确保获得这些关键全息影像的最大稳定性。

### <a name="release-local-spatial-anchors-you-no-longer-need"></a>释放你不再需要的局部空间定位点

当本地空间定位点处于活动状态时，系统优先保留靠近该定位点的传感器数据。 如果不再使用空间定位点，请停止访问其坐标系。 这允许在必要时删除其基础传感器数据。

对于已持久保存在空间定位点存储中的本地定位点，这一点尤其重要。 这些定位点后面的传感器数据将永久保留，使应用程序能够在将来的会话中找到该定位点，从而减少可用于跟踪其他定位点的空间。 仅保留需要在将来的会话中再次查找的本地定位点。 建议在用户不再有意义时将它们从存储中删除。

对于云空间定位点，存储可以根据场景需要进行扩展。 可以存储所需的数量云定位点，在知道用户不需要定位点时释放这些定位点。

## <a name="see-also"></a>另请参阅

* [坐标系统](coordinate-systems.md)
* [混合现实中的共享体验](../develop/platform-capabilities-and-apis/shared-experiences-in-mixed-reality.md)
* <a href="/azure/spatial-anchors" target="_blank">Azure 空间定位点</a>
* [Unity 中的持久性](../develop/unity/persistence-in-unity.md)
* [DirectX 中的空间定位点](../develop/native/coordinate-systems-in-directx.md#place-holograms-in-the-world-using-spatial-anchors)
* [案例研究 - 看透现实中的洞](../out-of-scope/case-study-looking-through-holes-in-your-reality.md)